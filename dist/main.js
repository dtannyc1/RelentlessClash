!function(){"use strict";!function(){class t{static BACKGROUND_OFFSET_X=-400;static BACKGROUND_OFFSET_Y=-200;static BACKGROUND_SCALE=.9;static CAMERA_LIMIT_LEFT=-400;static CAMERA_LIMIT_RIGHT=225;static FLOOR=175;static BACKGROUND_IMAGES=[["assets/images/Backgrounds/Postapocalypce4/Bright/bg.png",0],["assets/images/Backgrounds/Postapocalypce4/Bright/rail&wall.png",.25],["assets/images/Backgrounds/Postapocalypce4/Bright/train.png",.5],["assets/images/Backgrounds/Postapocalypce4/Bright/columns&floor.png",.75]];static FOREGROUND_IMAGES=[["assets/images/Backgrounds/Postapocalypce4/Bright/infopost&wires.png",1],["assets/images/Backgrounds/Postapocalypce4/Bright/wires.png",1],["assets/images/Backgrounds/Postapocalypce4/Bright/floor&underfloor.png",1]];constructor(e){this.ctx=e,this.CAMERA_LIMIT_LEFT=t.CAMERA_LIMIT_LEFT,this.CAMERA_LIMIT_RIGHT=t.CAMERA_LIMIT_RIGHT,this.FLOOR=t.FLOOR;let s=document.querySelector("body");this.backgroundImgs=[],this.foregroundImgs=[];for(let e=0;e<t.BACKGROUND_IMAGES.length;e++){let i=document.createElement("img");i.src=t.BACKGROUND_IMAGES[e][0],i.id=`background-${e}`,i.hidden=!0,s.appendChild(i),this.backgroundImgs.push(i)}for(let e=0;e<t.FOREGROUND_IMAGES.length;e++){let i=document.createElement("img");i.src=t.FOREGROUND_IMAGES[e][0],i.id=`foreground-${e}`,i.hidden=!0,s.appendChild(i),this.foregroundImgs.push(i)}}drawBackground(e,s){this.ctx.resetTransform();for(let i=0;i<t.BACKGROUND_IMAGES.length;i++){let a=t.BACKGROUND_IMAGES[i][1],n=-s*(t.BACKGROUND_OFFSET_X-e*a),r=-s*t.BACKGROUND_OFFSET_Y,o=720/t.BACKGROUND_SCALE/s,h=540/t.BACKGROUND_SCALE/s;this.ctx.drawImage(this.backgroundImgs[i],n,r,o,h,0,0,720,540)}}drawForeground(e,s){this.ctx.resetTransform();for(let i=0;i<t.FOREGROUND_IMAGES.length;i++){let a=t.FOREGROUND_IMAGES[i][1],n=-(t.BACKGROUND_OFFSET_X-e*a)/s,r=-t.BACKGROUND_OFFSET_Y/s,o=720/t.BACKGROUND_SCALE/s,h=540/t.BACKGROUND_SCALE/s;this.ctx.drawImage(this.foregroundImgs[i],n,r,o,h,0,0,720,540)}}}class e{static BACKGROUND_OFFSET_X=-400;static BACKGROUND_OFFSET_Y=-150;static BACKGROUND_SCALE=.85;static CAMERA_LIMIT_LEFT=-400;static CAMERA_LIMIT_RIGHT=190;static FLOOR=240;static BACKGROUND_IMAGES=[["assets/images/Backgrounds/War3/Bright/sky_sun.png",0],["assets/images/Backgrounds/War3/Bright/houses3.png",.25],["assets/images/Backgrounds/War3/Bright/houses2.png",.5],["assets/images/Backgrounds/War3/Bright/trees.png",.75],["assets/images/Backgrounds/War3/Bright/house&fountain.png",.75]];static FOREGROUND_IMAGES=[["assets/images/Backgrounds/War3/Bright/fence.png",1],["assets/images/Backgrounds/War3/Bright/road.png",1]];constructor(t){this.ctx=t,this.FLOOR=e.FLOOR,this.CAMERA_LIMIT_LEFT=e.CAMERA_LIMIT_LEFT,this.CAMERA_LIMIT_RIGHT=e.CAMERA_LIMIT_RIGHT;let s=document.querySelector("body");this.backgroundImgs=[],this.foregroundImgs=[];for(let t=0;t<e.BACKGROUND_IMAGES.length;t++){let i=document.createElement("img");i.src=e.BACKGROUND_IMAGES[t][0],i.id=`background-${t}`,i.hidden=!0,s.appendChild(i),this.backgroundImgs.push(i)}for(let t=0;t<e.FOREGROUND_IMAGES.length;t++){let i=document.createElement("img");i.src=e.FOREGROUND_IMAGES[t][0],i.id=`foreground-${t}`,i.hidden=!0,s.appendChild(i),this.foregroundImgs.push(i)}}drawBackground(t,s){this.ctx.resetTransform();for(let i=0;i<e.BACKGROUND_IMAGES.length;i++){let a=e.BACKGROUND_IMAGES[i][1],n=-s*(e.BACKGROUND_OFFSET_X-t*a),r=-s*e.BACKGROUND_OFFSET_Y,o=720/e.BACKGROUND_SCALE/s,h=540/e.BACKGROUND_SCALE/s;this.ctx.drawImage(this.backgroundImgs[i],n,r,o,h,0,0,720,540)}}drawForeground(t,s){this.ctx.resetTransform();for(let i=0;i<e.FOREGROUND_IMAGES.length;i++){let a=e.FOREGROUND_IMAGES[i][1],n=-(e.BACKGROUND_OFFSET_X-t*a)/s,r=-e.BACKGROUND_OFFSET_Y/s,o=720/e.BACKGROUND_SCALE/s,h=540/e.BACKGROUND_SCALE/s;this.ctx.drawImage(this.foregroundImgs[i],n,r,o,h,0,0,720,540)}}}class s{static MAIN_SCALE=.75;static WIDTH=960*s.MAIN_SCALE;static HEIGHT=720*s.MAIN_SCALE;constructor(t){this.ctx=t,this.camera_location=0,this.loadStages(),this.randomizeStage()}loadStages(){this.stages=[],this.stages.push(new t(this.ctx)),this.stages.push(new e(this.ctx))}randomizeStage(){this.background=this.stages[Math.floor(Math.random()*this.stages.length)]}draw(t){let e=this.ctx;e.resetTransform(),e.clearRect(0,0,s.WIDTH,s.HEIGHT),this.calculateCameraLocation(t),this.background.drawBackground(this.camera_location,s.MAIN_SCALE),t.forEach((t=>{e.resetTransform(),e.translate(s.WIDTH/2,0),e.scale(s.MAIN_SCALE,s.MAIN_SCALE),e.translate(-this.camera_location,0),t.draw(e)})),this.enforceCameraLimits(t),this.background.drawForeground(this.camera_location,s.MAIN_SCALE),this.drawHealthBars(t)}calculateCameraLocation(t){let e=0;t.forEach((t=>{e+=t.pos[0]}));let s=e/t.length;s<this.background.CAMERA_LIMIT_LEFT?this.camera_location=this.background.CAMERA_LIMIT_LEFT:s>this.background.CAMERA_LIMIT_RIGHT?this.camera_location=this.background.CAMERA_LIMIT_RIGHT:this.camera_location=s}drawHealthBars(t){let e=this.ctx,i=.04*s.WIDTH,a=.96*s.WIDTH,n=.4*s.WIDTH,r="0, 220, 0",o="170, 0, 0";t.forEach((t=>{let s,h,l;e.resetTransform(),"player1"===t.name?(s=[i,i],h=n,l=1):(s=[a,i],h=-n,l=-1);for(let i=5;i>=0;i--)100===t.health?(e.strokeStyle=`rgb(${r}, ${.25+(5-i)/5*.75})`,e.lineWidth=18+i,e.beginPath(),e.moveTo(s[0]-i*l,s[1]),e.lineTo(s[0]+t.health/100*h+i*l,s[1]),e.stroke()):0===t.health?(e.beginPath(),e.lineWidth=18+i,e.strokeStyle=`rgb(${o}, ${.25+(5-i)/5*.75})`,e.moveTo(s[0]+t.health/100*h-i*l,s[1]),e.lineTo(s[0]+h+i*l,s[1]),e.stroke()):(e.strokeStyle=`rgb(${r}, ${.25+(5-i)/5*.75})`,e.lineWidth=18+i,e.beginPath(),e.moveTo(s[0]-i*l,s[1]),e.lineTo(s[0]+t.health/100*h,s[1]),e.stroke(),e.beginPath(),e.strokeStyle=`rgb(${o}, ${.25+(5-i)/5*.75})`,e.moveTo(s[0]+t.health/100*h,s[1]),e.lineTo(s[0]+h+i*l,s[1]),e.stroke())}))}enforceCameraLimits(t){t.forEach((t=>{let e=t.getHurtBoxes(s.MAIN_SCALE)[1],i=e[0],a=e[0]+e[2];if(i-this.camera_location*s.MAIN_SCALE<-s.WIDTH/2){let e=i-this.camera_location*s.MAIN_SCALE+s.WIDTH/2;t.pos[0]-=e}else if(a-this.camera_location*s.MAIN_SCALE>s.WIDTH/2){let e=a-this.camera_location*s.MAIN_SCALE-s.WIDTH/2;t.pos[0]-=e}}))}renderScore(t){let e=t.join(" - ");this.ctx.font="28px Arial",this.ctx.fillStyle="yellow",this.ctx.textAlign="center",this.ctx.fillText(e,.5*s.WIDTH,.053*s.WIDTH)}}class i{constructor(t,e,s,i,a,n){let r=document.querySelector("body"),o=document.createElement("img");o.src=e,o.id=`${t.name}-sprite`,o.hidden=!0,r.appendChild(o),this.player=t,this.img=document.getElementById(o.id),this.frameWidth=s,this.frameHeight=i,this.animationFrameInfo=a,this.singleActions=n,this.framePosX=0,this.framePosY=0,this.draw=this.draw.bind(this),this.currentAction=this.currentAction.bind(this),this.stopAction=this.stopAction.bind(this),this.animate=this.animate.bind(this),this.resetHurtBoxes(),this.resetHitBox()}draw(t,e,s){t.translate(e[0],e[1]),-1===this.player.xFacing&&t.scale(-1,1),t.drawImage(this.img,this.framePosX,this.framePosY,this.frameWidth,this.frameHeight,-this.frameWidth*s/2,0,this.frameWidth*s,this.frameHeight*s),t.scale(s,s),t.translate(-this.frameWidth/2,0),this.player.renderBoxes&&(t.fillStyle="#00ff0050",this.hurtboxes.forEach((e=>{t.fillRect(...e)})),t.fillStyle="#ff000050",this.hitboxes.forEach((e=>{t.fillRect(...e)})))}currentAction(t){this.singleActions.includes(t)?this.animate(t,!0):this.animate(t)}stopAction(t){if(this.animationFrameInfo[t].framenum=0,this.player.controller.heldButtons.length>0){let t=this.player.controller.heldButtons;switch(t[t.length-1]){case"LEFT":this.player.vel[0]=-1*this.player.moveSpeed,this.player.currentAction="run";break;case"RIGHT":this.player.vel[0]=this.player.moveSpeed,this.player.currentAction="run";break;default:this.player.currentAction="idle"}}else this.player.currentAction="idle"}animate(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.animationFrameInfo[t].framenum+=1;let s=this.animationFrameInfo[t].framenum,i=this.animationFrameInfo[t].frames.reduce(((t,e)=>t+e),0);if(e&&s>=i)this.stopAction(t);else{s=(s+i)%i;let e,a=0;for(let i=0;i<this.animationFrameInfo[t].frames.length;i++)if(a+=this.animationFrameInfo[t].frames[i],a>s){e=i;break}let n=this.animationFrameInfo[t].originY;this.framePosX=e*this.frameWidth,this.framePosY=n*this.frameHeight,this.animationFrameInfo[t].hurtboxes?this.updateHurtboxes(this.animationFrameInfo[t].hurtboxes[e]):this.resetHurtBoxes(),this.animationFrameInfo[t].hitboxes?this.updateHitBox(this.animationFrameInfo[t].hitboxes[e]):this.resetHitBox()}}resetHurtBoxes(){this.hurtboxes=[[0,0,0,0],[0,0,0,0],[0,0,0,0]]}updateHurtboxes(t){this.hurtboxes=t}resetHitBox(){this.hitboxes=[[0,0,0,0]]}updateHitBox(t){this.hitboxes=[t]}}class a extends i{static imgSrc="assets/images/Sprite Sheets/Samurai_Commander/SamuraiCommanderSheet.png";static frameWidth=128;static frameHeight=128;static animationFrameInfo={idle:{framenum:0,originY:0,frames:Array(5).fill(12),hurtboxes:[[[54,57,18,14],[51,71,27,40],[52,109,26,17]],[[54,57,18,14],[51,71,27,40],[52,109,26,17]],[[54,57,18,14],[51,71,27,40],[52,109,26,17]],[[54,57,18,14],[51,71,27,40],[52,109,26,17]],[[54,57,18,14],[51,71,27,40],[52,109,26,17]]]},run:{framenum:0,originY:1,frames:Array(8).fill(6),hurtboxes:[[[79,60,15,15],[58,69,30,42],[57,104,23,22]],[[79,60,15,15],[58,69,30,42],[57,104,23,22]],[[79,60,15,15],[58,69,30,42],[55,104,32,22]],[[79,60,15,15],[58,69,30,42],[53,104,37,22]],[[79,60,15,15],[58,69,30,42],[57,104,23,22]],[[79,60,15,15],[58,69,30,42],[57,104,23,22]],[[79,60,15,15],[58,69,30,42],[55,104,32,22]],[[79,60,15,15],[58,69,30,42],[53,104,37,22]]]},walk:{framenum:0,originY:2,frames:[4,4,4,4,4,4,4,4,4]},jump:{framenum:0,originY:3,frames:[8,8,10,9,9,8,8],hurtboxes:[[[62,68,14,14],[55,80,22,30],[54,110,32,16]],[[64,48,13,14],[56,59,21,35],[53,92,20,28]],[[64,53,13,14],[59,62,20,30],[61,89,28,22]],[[65,53,12,14],[58,63,23,29],[61,93,28,20]],[[64,55,14,14],[54,67,22,32],[48,99,23,21]],[[65,80,12,15],[53,86,26,27],[57,110,27,16]],[[65,80,12,15],[53,86,26,27],[57,110,26,16]]]},attack1:{framenum:0,originY:4,frames:[2,2,3,3],hurtboxes:[[[48,60,16,15],[43,73,27,36],[34,108,41,18]],[[48,60,16,15],[43,73,27,36],[34,108,41,18]],[[59,60,15,15],[42,72,42,38],[34,108,41,18]],[[58,60,17,15],[41,72,34,36],[36,109,40,18]]],hitboxes:[[0,0,0,0],[0,0,0,0],[83,68,38,35],[79,67,37,11]]},attack2:{framenum:0,originY:6,frames:[6,8,6,5],hurtboxes:[[[63,65,13,15],[43,79,33,32],[35,109,39,17]],[[56,60,12,15],[47,73,24,40],[35,109,39,17]],[[61,62,10,10],[44,72,34,29],[35,100,40,26]],[[61,62,10,10],[44,72,34,29],[35,100,40,26]]],hitboxes:[[0,0,0,0],[0,0,0,0],[84,57,32,41],[83,55,15,17]]},attack3:{framenum:0,originY:5,frames:[3,6,8,4,4],hurtboxes:[[[51,59,14,11],[51,69,22,39],[44,107,33,19]],[[54,59,13,10],[52,69,20,38],[44,108,31,18]],[[54,59,13,10],[52,69,20,38],[44,108,31,18]],[[55,59,13,13],[55,72,22,34],[44,104,36,22]],[[72,65,13,15],[51,79,33,30],[45,108,38,18]]],hitboxes:[[31,50,42,9],[43,27,29,28],[56,21,19,32],[87,28,11,37],[87,75,39,35]]},hurt:{framenum:0,originY:7,frames:[4,4,4],hurtboxes:[[[46,58,13,14],[46,71,24,37],[43,107,28,19]],[[45,57,13,15],[45,71,23,36],[43,103,29,23]],[[44,58,13,14],[44,70,24,37],[42,104,31,22]]]},dead:{framenum:0,originY:8,frames:[4,4,6,30,6,1e3]},guard:{framenum:0,originY:9,frames:[2,2]}};static POSSIBLE_MOVES={idle:["idle","run","walk","jump","attack1","attack2","attack3","hurt","dead","guard"],run:["idle","run","walk","jump","attack1","attack2","attack3","hurt","dead","guard"],walk:["idle","run","walk","jump","attack1","attack2","attack3","hurt","dead","guard"],jump:["idle","attack1","attack2","attack3","hurt","dead","guard"],attack1:["idle","hurt","dead"],attack2:["idle","hurt","dead"],attack3:["idle","hurt","dead"],hurt:["idle","hurt","dead"],dead:[],guard:["idle","run","walk","jump","attack1","attack2","attack3","hurt","dead","guard"]};static SINGLE_ACTIONS=["attack1","attack2","attack3","jump","hurt"];constructor(t){super(t,a.imgSrc,a.frameWidth,a.frameHeight,a.animationFrameInfo,a.SINGLE_ACTIONS),this.possibleMoves=a.POSSIBLE_MOVES}}class n extends i{static imgSrc="assets/images/Sprite Sheets/Samurai/SpriteSheet.png";static frameWidth=128;static frameHeight=128;static animationFrameInfo={idle:{framenum:0,originY:0,frames:Array(6).fill(12),hurtboxes:[[[54,57,18,14],[51,71,27,40],[52,109,26,17]],[[54,57,18,14],[51,71,27,40],[52,109,26,17]],[[54,57,18,14],[51,71,27,40],[52,109,26,17]],[[54,57,18,14],[51,71,27,40],[52,109,26,17]],[[54,57,18,14],[51,71,27,40],[52,109,26,17]],[[54,57,18,14],[51,71,27,40],[52,109,26,17]]]},run:{framenum:0,originY:1,frames:Array(8).fill(6),hurtboxes:[[[79,60,15,15],[58,69,30,42],[57,104,23,22]],[[79,60,15,15],[58,69,30,42],[57,104,23,22]],[[79,60,15,15],[58,69,30,42],[55,104,32,22]],[[79,60,15,15],[58,69,30,42],[53,104,37,22]],[[79,60,15,15],[58,69,30,42],[57,104,23,22]],[[79,60,15,15],[58,69,30,42],[57,104,23,22]],[[79,60,15,15],[58,69,30,42],[55,104,32,22]],[[79,60,15,15],[58,69,30,42],[53,104,37,22]]]},walk:{framenum:0,originY:2,frames:[4,4,4,4,4,4,4,4,4]},jump:{framenum:0,originY:3,frames:[4,7,7,7,7,7,7,7,7],hurtboxes:[[[71,58,17,15],[58,71,27,38],[53,110,36,16]],[[60,65,16,14],[57,77,22,34],[54,109,32,17]],[[62,68,14,14],[55,80,22,30],[54,110,32,16]],[[64,48,13,14],[56,59,21,35],[53,92,20,28]],[[64,53,13,14],[59,62,20,30],[61,89,28,22]],[[65,53,12,14],[58,63,23,29],[61,93,28,20]],[[64,55,14,14],[54,67,22,32],[48,99,23,21]],[[65,80,12,15],[53,86,26,27],[57,110,27,16]],[[65,80,12,15],[53,86,26,27],[57,110,26,16]]]},attack1:{framenum:0,originY:4,frames:[2,2,3,3],hurtboxes:[[[48,60,16,15],[43,73,27,36],[34,108,41,18]],[[48,60,16,15],[43,73,27,36],[34,108,41,18]],[[59,60,15,15],[42,72,42,38],[34,108,41,18]],[[58,60,17,15],[41,72,34,36],[36,109,40,18]]],hitboxes:[[0,0,0,0],[0,0,0,0],[83,68,38,35],[79,67,37,11]]},attack2:{framenum:0,originY:6,frames:[6,8,6,5],hurtboxes:[[[63,65,13,15],[43,79,33,32],[35,109,39,17]],[[56,60,12,15],[47,73,24,40],[35,109,39,17]],[[61,62,10,10],[44,72,34,29],[35,100,40,26]],[[61,62,10,10],[44,72,34,29],[35,100,40,26]]],hitboxes:[[0,0,0,0],[0,0,0,0],[84,57,32,41],[83,55,15,17]]},attack3:{framenum:0,originY:5,frames:[3,6,8,4,4],hurtboxes:[[[51,59,14,11],[51,69,22,39],[44,107,33,19]],[[54,59,13,10],[52,69,20,38],[44,108,31,18]],[[54,59,13,10],[52,69,20,38],[44,108,31,18]],[[55,59,13,13],[55,72,22,34],[44,104,36,22]],[[72,65,13,15],[51,79,33,30],[45,108,38,18]]],hitboxes:[[31,50,42,9],[43,27,29,28],[56,21,19,32],[87,28,11,37],[87,75,39,35]]},hurt:{framenum:0,originY:7,frames:[4,4,4],hurtboxes:[[[46,58,13,14],[46,71,24,37],[43,107,28,19]],[[45,57,13,15],[45,71,23,36],[43,103,29,23]],[[44,58,13,14],[44,70,24,37],[42,104,31,22]]]},dead:{framenum:0,originY:8,frames:[4,4,6,30,6,1e3]},guard:{framenum:0,originY:9,frames:[2,2]}};static POSSIBLE_MOVES={idle:["idle","run","walk","jump","attack1","attack2","attack3","hurt","dead","guard"],run:["idle","run","walk","jump","attack1","attack2","attack3","hurt","dead","guard"],walk:["idle","run","walk","jump","attack1","attack2","attack3","hurt","dead","guard"],jump:["idle","attack1","attack2","attack3","hurt","dead","guard"],attack1:["idle","hurt","dead"],attack2:["idle","hurt","dead"],attack3:["idle","hurt","dead"],hurt:["idle","hurt","dead"],dead:[],guard:["idle","run","walk","jump","attack1","attack2","attack3","hurt","dead","guard"]};static SINGLE_ACTIONS=["attack1","attack2","attack3","jump","hurt"];constructor(t){super(t,n.imgSrc,n.frameWidth,n.frameHeight,n.animationFrameInfo,n.SINGLE_ACTIONS),this.possibleMoves=n.POSSIBLE_MOVES}}class r{static GRAVITY=[.5,.75];constructor(t){this.pos=t.startpos,this.vel=[0,0],this.FLOOR=t.floor}move(){this.pos[1]===this.FLOOR&&"run"!==this.currentAction&&(this.vel[0]<-r.GRAVITY[0]?this.vel[0]+=r.GRAVITY[0]:this.vel[0]>r.GRAVITY[0]?this.vel[0]-=r.GRAVITY[0]:this.vel[0]=0),this.pos[0]+=this.vel[0],this.vel[1]+=r.GRAVITY[1],this.pos[1]+=this.vel[1],this.checkFloor(),this.checkFacing()}setFloor(t){this.FLOOR=t}checkFloor(){this.pos[1]>this.FLOOR&&(this.vel[1]=0,this.pos[1]=this.FLOOR)}checkFacing(){this.vel[0]<0?this.xFacing=-1:this.vel[0]>0&&(this.xFacing=1)}draw(){throw new Error("Draw not implemented?")}}class o extends r{constructor(t){super(t),this.name=t.name,"player1"===this.name?(this.xFacing=1,this.character=new n(this)):(this.xFacing=-1,this.character=new a(this)),this.moveSpeed=10,this.scale=3.15,this.health=100,this.setupMusic(),this.currentAction="idle",this.renderBoxes=!1,this.handleButtonPress=this.handleButtonPress.bind(this),this.handleButtonRelease=this.handleButtonRelease.bind(this),this.stun=this.stun.bind(this),this.unstun=this.unstun.bind(this),this.runAnimationState=this.runAnimationState.bind(this),this.togglePlayingAudio=this.togglePlayingAudio.bind(this),this.mute=this.mute.bind(this),this.unmute=this.unmute.bind(this),this.playSwordSound=this.playSwordSound.bind(this),this.stunned=!1,this.runAnimation=!0}draw(t){this.move(),this.runAnimation&&this.character.currentAction(this.currentAction),this.character.draw(t,this.pos,this.scale)}assignController(t){this.controller=t,this.controller.assignPlayer(this)}getHurtBoxes(t){return this.character.hurtboxes?this.calculateBoxes(t,this.character.hurtboxes):[]}getHitBoxes(t){return this.character.hitboxes?this.calculateBoxes(t,this.character.hitboxes):[]}calculateBoxes(t,e){let s=e,i=this.pos,a=this.xFacing,n=this.scale,r=this.character.frameWidth,o=[];for(let e=0;e<s.length;e++){let h=s[e].slice();h[0]=1===a?i[0]-r*n/2+h[0]*n:i[0]+r*n/2-h[0]*n-h[2]*n,h[1]=i[1]+h[1]*n,h[2]*=n,h[3]*=n,h[0]*=t,h[1]*=t,h[2]*=t,h[3]*=t,o.push(h)}return o}toggleRenderBoxes(){this.renderBoxes=!this.renderBoxes}handleButtonPress(t){if(!this.stunned){let e=this.character.possibleMoves[this.currentAction];switch(t){case"LEFT":e.includes("run")?(this.vel[0]=-1*this.moveSpeed,this.currentAction="run"):this.vel[0]=-1*this.moveSpeed;break;case"RIGHT":e.includes("run")?(this.vel[0]=1*this.moveSpeed,this.currentAction="run"):this.vel[0]=1*this.moveSpeed;break;case"UP":this.pos[1]===this.FLOOR&&e.includes("jump")&&(this.vel[1]=-2*this.moveSpeed,this.currentAction="jump");break;case"B":e.includes("attack1")&&(this.currentAction="attack1",this.playingAudio||(this.playSwordSound(),this.playingAudio=!0,setTimeout(this.togglePlayingAudio,500)));break;case"Y":e.includes("attack2")&&(this.currentAction="attack2",this.playingAudio||(setTimeout(this.playSwordSound,100),this.playingAudio=!0,setTimeout(this.togglePlayingAudio,500)));break;case"X":e.includes("attack3")&&(this.currentAction="attack3",this.playingAudio||(setTimeout(this.playSwordSound,150),this.playingAudio=!0,setTimeout(this.togglePlayingAudio,500)))}}}handleButtonRelease(t){if(!this.stunned)switch(t){case"LEFT":this.vel[0]<0&&"run"===this.currentAction&&(this.vel[0]=0,this.character.stopAction("run"));break;case"RIGHT":this.vel[0]>0&&"run"===this.currentAction&&(this.vel[0]=0,this.character.stopAction("run"))}}stun(t){this.stunned=!0,t&&setTimeout(this.unstun,t)}unstun(){this.stunned=!1}runAnimationState(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.runAnimation=t}setupMusic(){this.swordSounds=[new Audio("assets/music/SwordSwipe1.mp3"),new Audio("assets/music/SwordSwipe2.mp3"),new Audio("assets/music/SwordSwipe3.mp3"),new Audio("assets/music/SwordSwipe4.mp3"),new Audio("assets/music/SwordSwipe5.mp3")],this.swordSounds.forEach((t=>{t.loop=!1})),this.playingAudio=!1}playSwordSound(){this.swordSounds[Math.floor(Math.random()*this.swordSounds.length)].play()}togglePlayingAudio(){this.playingAudio=!this.playingAudio}mute(){this.swordSounds.forEach((t=>{t.volume=0}))}unmute(){this.swordSounds.forEach((t=>{t.volume=1}))}}class h{static PLAYER1_STARTX=-240;static PLAYER2_STARTX=240;static KNOCKBACK=10;constructor(t,e,i,a){this.gameView=new s(t),this.FLOOR=this.gameView.background.FLOOR,this.player1=new o({startpos:[h.PLAYER1_STARTX,.75*this.FLOOR],name:"player1",floor:this.FLOOR}),this.controller1=e,this.player1.assignController(this.controller1),this.player2=new o({startpos:[h.PLAYER2_STARTX,.75*this.FLOOR],name:"player2",floor:this.FLOOR}),this.controller2=i,this.player2.assignController(this.controller2),this.controller1.assignOpponent(this.player2),this.controller2.assignOpponent(this.player1),this.objects=[this.player1,this.player2],this.scores=[0,0],this.gameOver=!1,this.paused=!0,this.setupMusic(),this.resetRound=this.resetRound.bind(this),this.endGame=this.endGame.bind(this),this.togglePlayingAudio=this.togglePlayingAudio.bind(this),this.mute=this.mute.bind(this),this.unmute=this.unmute.bind(this),this.menu=a}start(){this.paused=!1,this.resetRound(),this.runGame()}runGame(){this.paused||(this.gameView.draw(this.objects),this.gameView.renderScore(this.scores),this.controller1.draw(),this.controller2.draw(),this.handleCollisions()),this.gameOver||requestAnimationFrame(this.runGame.bind(this))}handleCollisions(){this.handleHit(),this.handlePush(),this.handleSwordCollisions()}handlePush(){for(let t=0;t<this.objects.length;t++){let e=this.objects[t].getHurtBoxes(s.MAIN_SCALE);for(let i=t+1;i<this.objects.length;i++){let a=this.objects[i].getHurtBoxes(s.MAIN_SCALE),n=!1,r=[];for(let t=0;t<e.length;t++){for(let s=0;s<a.length;s++){let i=e[t].slice(),o=a[s].slice();if(n=this.overlappingBoxes(i,o),n){r.push(i),r.push(o);break}}if(n)break}if(n){let e=r[0],s=r[1],a=this.objects[t],n=this.objects[i];if(e[0]<s[0]){let t=(e[0]+e[3]-s[0])/2;a.pos[0]-=t,n.pos[0]+=t}else{let t=(s[0]+s[3]-e[0])/2;n.pos[0]-=t,a.pos[0]+=t}}}}}handleHit(){let t=[];for(let e=0;e<this.objects.length;e++){let i=this.objects[e].getHitBoxes(s.MAIN_SCALE);if(i){i=i[0];for(let a=0;a<this.objects.length;a++)if(a!==e){let n=!1,r=this.objects[a].getHurtBoxes(s.MAIN_SCALE);for(let s=0;s<r.length;s++)if(this.overlappingBoxes(i,r[s])){t.push([this.objects[e],this.objects[a],s]),n=!0;break}if(n)break}}}if(t.length>0){let e=!1;t.forEach((t=>{let s=t[0],i=t[1],a=t[2],n=0;switch(s.currentAction){case"attack1":n=1;break;case"attack2":n=2;break;case"attack3":n=3}i.health-=n*(3-a)*.25,i.health<0&&(e=!0,i.health=0),s.pos[0]<i.pos[0]?i.pos[0]+=h.KNOCKBACK*n:i.pos[0]-=h.KNOCKBACK*n})),e&&this.isRoundOver()}}handleSwordCollisions(){let t=[];for(let e=0;e<this.objects.length;e++){let i=this.objects[e].getHitBoxes(s.MAIN_SCALE);if(i){i=i[0];for(let a=0;a<this.objects.length;a++)if(a!==e){let n=this.objects[a].getHitBoxes(s.MAIN_SCALE);if(n&&(n=n[0],this.overlappingBoxes(i,n))){t.push([this.objects[e],this.objects[a]]);break}}}}t.length>0&&(this.playingAudio||(this.swordClashSound.play(),this.playingAudio=!0,setTimeout(this.togglePlayingAudio,500))),t.forEach((t=>{let e=t[0],s=t[1],i=4;switch(e.currentAction){case"attack1":i*=1;break;case"attack2":i*=2;break;case"attack3":i*=3}e.pos[0]<s.pos[0]?s.pos[0]+=h.KNOCKBACK*i:s.pos[0]-=h.KNOCKBACK*i}))}overlappingBoxes(t,e){let s,i,a,n,r,o,h,l;return[s,i,a,n]=[t[0],t[1],t[0]+t[2],t[1]+t[3]],[r,o,h,l]=[e[0],e[1],e[0]+e[2],e[1]+e[3]],!(r>=a||s>=h||o>=n||i>=l)}toggleRenderBoxes(){this.player1.toggleRenderBoxes(),this.player2.toggleRenderBoxes()}isRoundOver(){0!==this.player1.health&&0!==this.player2.health||(this.roundOver=!0,0===this.player1.health&&0===this.player2.health?(this.player1.currentAction="dead",this.player2.currentAction="dead",this.player1.stun(5e3),this.player2.stun(5e3)):0===this.player1.health?(this.scores[1]+=1,this.player1.currentAction="dead",this.player2.runAnimationState(!1),this.player1.stun(5e3),this.player2.stun(5e3)):(this.scores[0]+=1,this.player2.currentAction="dead",this.player1.runAnimationState(!1),this.player1.stun(5e3),this.player2.stun(5e3)),this.isGameOver()?setTimeout(this.endGame,4500):setTimeout(this.resetRound,4500))}isGameOver(){return Math.abs(this.scores[0]-this.scores[1])>=2}endGame(){this.gameOver=!0,this.player1.stun(),this.player2.stun(),this.menu.stopGame()}randomizeStage(){this.gameView.randomizeStage(),this.FLOOR=this.gameView.background.FLOOR,this.player1.setFloor(this.FLOOR),this.player2.setFloor(this.FLOOR)}resetRound(){this.randomizeStage(),this.player1.pos=[h.PLAYER1_STARTX,.75*this.FLOOR],this.player2.pos=[h.PLAYER2_STARTX,.75*this.FLOOR],this.player1.health=100,this.player2.health=100,this.player1.currentAction="jump",this.player2.currentAction="jump",this.player1.character.animationFrameInfo.jump.framenum=32,this.player2.character.animationFrameInfo.jump.framenum=32,this.player1.xFacing=1,this.player2.xFacing=-1,this.player1.runAnimationState(),this.player2.runAnimationState(),this.player1.stun(1e3),this.player2.stun(1e3),this.roundOver=!1}pause(){this.paused=!0,this.player1.stun(),this.player2.stun()}unpause(){this.paused=!1,this.player1.unstun(),this.player2.unstun()}winner(){return this.scores[0]>this.scores[1]?"Player 1":"Player 2"}setupMusic(){this.swordClashSound=new Audio("assets/music/SwordClash.mp3"),this.swordClashSound.loop=!1,this.playingAudio=!1}mute(){this.swordClashSound.volume=0,this.player1.mute(),this.player2.mute()}unmute(){this.swordClashSound.volume=1,this.player1.unmute(),this.player2.unmute()}togglePlayingAudio(){this.playingAudio=!1}}class l{constructor(t,e,s){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(this.buttonMapping=void 0,this.imgs=[],this.ctx=s,this.player=t,1===e){this.buttonMapping=l.CONTROLLER_ONE;let t=document.querySelector("body");for(const[e,s]of Object.entries(l.CONTROLLER_ONE_IMG_SRC)){let i=document.createElement("img");i.src=s,i.id=`controller1-${e}`,i.hidden=!0,t.appendChild(i),this.imgs.push([e,i])}}else if(2===e){this.buttonMapping=l.CONTROLLER_TWO;let t=document.querySelector("body");for(const[e,s]of Object.entries(l.CONTROLLER_TWO_IMG_SRC)){let i=document.createElement("img");i.src=s,i.id=`controller2-${e}`,i.hidden=!0,t.appendChild(i),this.imgs.push([e,i])}}this.heldButtons=[],this.handleKeyDown=this.handleKeyDown.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),i&&this.addListeners(),this.draw=this.draw.bind(this)}addListeners(){window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp)}removeListeners(){window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp)}assignPlayer(t){this.player=t}assignOpponent(t){this.opponent=t}handleKeyDown(t){this.buttonMapping[t.key]&&(this.heldButtons.includes(this.buttonMapping[t.key])||(this.heldButtons.push(this.buttonMapping[t.key]),this.player&&this.player.handleButtonPress(this.buttonMapping[t.key])))}handleKeyUp(t){if(this.buttonMapping[t.key]&&this.heldButtons.includes(this.buttonMapping[t.key])){let e=this.heldButtons.indexOf(this.buttonMapping[t.key]);this.heldButtons.splice(e,1),this.player&&this.player.handleButtonRelease(this.buttonMapping[t.key])}}draw(){this.ctx.resetTransform(),this.ctx.clearRect(0,0,663,227),this.imgs.forEach((t=>{let e=t[0],s=t[1];this.heldButtons.includes(e)?this.ctx.drawImage(s,0,5,663,227):this.ctx.drawImage(s,0,0,663,227)}))}static CONTROLLER_ONE={f:"B",g:"Y",h:"X",r:"LB",t:"A",y:"RB",w:"UP",s:"DOWN",a:"LEFT",d:"RIGHT"};static CONTROLLER_TWO={";":"B",l:"Y",k:"X",i:"LB",o:"A",p:"RB",ArrowUp:"UP",ArrowDown:"DOWN",ArrowLeft:"LEFT",ArrowRight:"RIGHT"};static CONTROLLER_ONE_IMG_SRC={UP:"assets/images/ControllerKeys/1up.png",LEFT:"assets/images/ControllerKeys/1left.png",DOWN:"assets/images/ControllerKeys/1down.png",RIGHT:"assets/images/ControllerKeys/1right.png",B:"assets/images/ControllerKeys/1attack1.png",Y:"assets/images/ControllerKeys/1attack2.png",X:"assets/images/ControllerKeys/1attack3.png"};static CONTROLLER_TWO_IMG_SRC={UP:"assets/images/ControllerKeys/2up.png",RIGHT:"assets/images/ControllerKeys/2right.png",DOWN:"assets/images/ControllerKeys/2down.png",LEFT:"assets/images/ControllerKeys/2left.png",B:"assets/images/ControllerKeys/2attack1.png",Y:"assets/images/ControllerKeys/2attack2.png",X:"assets/images/ControllerKeys/2attack3.png"}}class d extends l{constructor(t,e,s,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6;super(t,e,s,!1),this.player=t,this.opponent=i,this.chooseAction=this.chooseAction.bind(this),this.takeAction=this.takeAction.bind(this),this.pressButton=this.pressButton.bind(this),this.releaseButton=this.releaseButton.bind(this),this.updateDistanceFromOpponent=this.updateDistanceFromOpponent.bind(this),this.difficulty=a,this.buttonReleaseDelay=250+250*(10-this.difficulty),this.relPos=[1e3,1e3]}startController(){setInterval(this.chooseAction,100+15*(10-this.difficulty))}assignOpponent(t){this.opponent=t,this.opponent&&this.player&&this.startController()}chooseAction(){this.updateDistanceFromOpponent(),Math.abs(this.relPos[0])>200&&10*Math.random()<this.difficulty?this.takeAction("run"):(10*Math.random()<this.difficulty&&this.takeAction("attack"),Math.abs(this.relPos[1])>20?10*Math.random()<this.difficulty&&this.takeAction("jump"):this.takeAction("idle"))}takeAction(t){if("attack"===t){let t=["B","Y","X"];if(!this.heldButtons.includes("B")&&!this.heldButtons.includes("Y")&&!this.heldButtons.includes("X")){let e=t[Math.floor(Math.random()*t.length)];this.pressButton(e),setTimeout((()=>this.releaseButton(e)),this.buttonReleaseDelay)}}else if("run"===t)this.relPos[0]>0?(this.releaseButton("LEFT"),0===this.player.vel[0]&&this.releaseButton("RIGHT"),this.pressButton("RIGHT")):this.relPos[0]<0&&(this.releaseButton("RIGHT"),0===this.player.vel[0]&&this.releaseButton("LEFT"),this.pressButton("LEFT"));else if("jump"===t)this.pressButton("UP"),setTimeout((()=>this.releaseButton("UP")),this.buttonReleaseDelay);else if("idle"===t)for(;this.heldButtons.length>0;)this.releaseButton(this.heldButtons[0])}pressButton(t){this.heldButtons.includes(t)||(this.heldButtons.push(t),this.player&&this.player.handleButtonPress(t))}releaseButton(t){-1!==this.heldButtons.indexOf(t)&&(this.heldButtons.splice(this.heldButtons.indexOf(t),1),this.player&&this.player.handleButtonRelease(t))}updateDistanceFromOpponent(){this.player&&this.opponent?(this.relPos[0]=this.opponent.pos[0]-this.player.pos[0],this.relPos[1]=this.opponent.pos[1]-this.player.pos[1]):console.log("Missing player or opponent")}}class u extends l{static BUTTON_MAPPING={0:"UP",1:"X",2:"B",3:"Y",4:"LB",5:"RB",6:"LT",7:"RT",8:"M",9:"P",10:"LJ",11:"RJ",12:"UP",13:"DOWN",14:"LEFT",15:"RIGHT",16:"HOME",17:"SS"};constructor(t,e){super(null,3,e,!1),this.gamepad=t,this.buttonMapping=Gamepad.BUTTON_MAPPING,this.gameLoop=this.gameLoop.bind(this),setInterval(this.gameLoop,100)}draw(){this.ctx.clearRect(0,0,1e3,1e3)}gameLoop(){if(this.player){let t=navigator.getGamepads()[this.gamepad.index];for(let e=0;e<t.buttons.length;e++){let s=u.BUTTON_MAPPING[e];t.buttons[e].pressed?this.player.handleButtonPress(s):this.player.handleButtonRelease(s)}let e=[t.axes[0],t.axes[1]];e[0]>.25?(this.player.handleButtonRelease("LEFT"),this.player.handleButtonPress("RIGHT")):e[0]<-.25&&(this.player.handleButtonRelease("RIGHT"),this.player.handleButtonPress("LEFT"))}}}let c=document.querySelector("#main-canvas");const m=c.getContext("2d");let p=document.querySelector("#controller1");p.width=663,p.height=227;const g=p.getContext("2d");let y=document.querySelector("#controller2");y.width=663,y.height=227;const f=y.getContext("2d");c.width=s.WIDTH,c.height=s.HEIGHT,c.style.backgroundColor="black";let A=new class{constructor(t,e,s){this.ctx=t,this.controller1ctx=e,this.controller2ctx=s,this.gameStarted=!1,this.computerplayer1=!0,this.computerplayer2=!0,this.difficulty1=5,this.difficulty2=5,this.controller1=new l(null,1,this.controller1ctx),this.controller2=new l(null,2,this.controller2ctx),this.bindMethods(),this.modalHolder=document.querySelector("#modal-holder"),this.modal=document.querySelector("#modal"),this.modalContent=document.querySelector("#main-modal-content"),this.modalButtons=document.querySelector("#modal-buttons"),this.howToButton=document.querySelector("#how-to-play"),this.startGameButton=document.querySelector("#start-game"),this.howToButton.addEventListener("click",this.generateHowToModal),this.startGameButton.addEventListener("click",this.startGame),this.showingModal=!1,this.addListeners(),this.draw(),this.setupMusic(),this.generateStartModal(),this.muteButton=document.querySelector("#mute-button"),this.muteButton.addEventListener("click",this.toggleMute)}generateStartModal(){let t=document.createElement("ul");t.classList.add("start-modal");let e=document.createElement("li"),s=document.createElement("li"),i=document.createElement("li");e.innerText="Welcome to a fast-action, sword-clashing, two-player fighting game!",s.innerText="Are you ready to challenge your opponent to an epic battle to the death?",i.innerText="Can you defeat the hyper aggressive level 10 computer player?",t.appendChild(e),t.appendChild(s),t.appendChild(i),this.modalContent.innerHTML="",this.modalContent.appendChild(t);let a=document.createElement("div"),n=document.createElement("div");a.innerText="Main Menu",n.innerText="How to Play",this.modalButtons.innerHTML="",this.modalButtons.appendChild(a),this.modalButtons.appendChild(n),a.addEventListener("click",(()=>{this.hideModal(),this.menuMusic.play()})),n.addEventListener("click",this.generateHowToModal),this.showModal()}generateHowToModal(){let t=document.createElement("ul"),e=document.createElement("li"),s=document.createElement("li"),i=document.createElement("li"),a=document.createElement("li"),n=document.createElement("li"),r=document.createElement("li");t.className="extra-top-padding",e.innerHTML="A/D/&larr;/&rarr; - Move Player",s.innerText="W/â†‘ - Jump",i.innerText="F/; - Light Attack",a.innerText="G/L - Medium Attack",n.innerText="H/K - Heavy Attack",r.innerText="ESC - Pause Game",t.appendChild(e),t.appendChild(s),t.appendChild(i),t.appendChild(a),t.appendChild(n),t.appendChild(r),this.modalContent.innerHTML="",this.modalContent.appendChild(t);let o=document.createElement("div"),h=document.createElement("div");o.innerText="Main Menu",h.innerText="Watch Computers Fight",this.modalButtons.innerHTML="",o.style.fontSize="2vh",h.style.fontSize="2vh",this.modalButtons.innerHTML="",this.modalButtons.appendChild(o),this.modalButtons.appendChild(h),o.addEventListener("click",(()=>{this.hideModal(),this.menuMusic.play()})),h.addEventListener("click",this.startComputerGame),o.onmouseover=()=>{o.style.fontSize="2.2vh"},o.onmouseout=()=>{o.style.fontSize="2vh"},h.onmouseover=()=>{h.style.fontSize="2.2vh"},h.onmouseout=()=>{h.style.fontSize="2vh"},this.showModal()}generatePauseModal(){let t=document.createElement("ul"),e=document.createElement("li"),s=document.createElement("li");e.innerText="GAME",s.innerText="PAUSED",t.appendChild(e),t.appendChild(s),e.style.fontSize="8vh",s.style.fontSize="8vh",t.style.lineHeight="9vh",this.modalContent.innerHTML="",this.modalContent.appendChild(t);let i=document.createElement("div"),a=document.createElement("div");i.innerText="Resume Game",a.innerText="Main Menu",this.modalButtons.innerHTML="",this.modalButtons.appendChild(i),this.modalButtons.appendChild(a),i.addEventListener("click",(()=>{this.game.unpause(),this.hideModal()})),a.addEventListener("click",(()=>{delete this.game,this.restartMenu(),this.hideModal()})),this.modal.style.background="#00000080",this.showModal()}generateEndModal(){let t=document.createElement("ul"),e=document.createElement("li"),s=document.createElement("li"),i=document.createElement("li");e.innerText="Thank you for playing!",this.lastWinner&&(s.innerText=`The winner is ${this.lastWinner}!`),i.innerText="Play Again?",t.appendChild(e),t.appendChild(s),t.appendChild(i),this.modalContent.innerHTML="",this.modalContent.appendChild(t);let a=document.createElement("div"),n=document.createElement("div");a.innerText="Play Again",n.innerText="Watch Computers Fight",a.style.fontSize="2vh",n.style.fontSize="2vh",this.modalButtons.innerHTML="",this.modalButtons.appendChild(a),this.modalButtons.appendChild(n),a.addEventListener("click",this.hideModal),n.addEventListener("click",this.startComputerGame),a.onmouseover=()=>{a.style.fontSize="2.2vh"},a.onmouseout=()=>{a.style.fontSize="2vh"},n.onmouseover=()=>{n.style.fontSize="2.2vh"},n.onmouseout=()=>{n.style.fontSize="2vh"},this.showModal()}startComputerGame(){this.computerplayer1=!0,this.computerplayer2=!0,this.difficulty1=10,this.difficulty2=10,this.hideModal(),this.startGame()}bindMethods(){this.handleKeyDown=this.handleKeyDown.bind(this),this.addGamePad=this.addGamePad.bind(this),this.generateStartModal=this.generateStartModal.bind(this),this.generateHowToModal=this.generateHowToModal.bind(this),this.generatePauseModal=this.generatePauseModal.bind(this),this.generateEndModal=this.generateEndModal.bind(this),this.showModal=this.showModal.bind(this),this.hideModal=this.hideModal.bind(this),this.startComputerGame=this.startComputerGame.bind(this),this.mute=this.mute.bind(this),this.unmute=this.unmute.bind(this),this.toggleMute=this.toggleMute.bind(this),this.startGame=this.startGame.bind(this)}showModal(){this.showingModal=!0,this.modalHolder.style.display="flex"}hideModal(){this.showingModal=!1,this.modal.style.background="#000000",this.modalHolder.style.display="none"}addListeners(){window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp)}removeListeners(){window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp)}draw(){this.ctx.clearRect(0,0,1920,1080),this.ctx.fillStyle="rgb(52,52,255)",this.ctx.textAlign="center",this.ctx.font="30px 'Press Start 2P'",this.ctx.fillText("Are you ready to fight?",s.WIDTH/2,.22*s.HEIGHT),this.ctx.font="20px 'Press Start 2P'";let t=["H: Join as Player 1","K: Join as Player 2","","W/S: Computer 1 Difficulty Level","Up/Down: Computer 2 Difficulty Level","","Press spacebar to start the game","Press escape to pause the game"];for(let e=0;e<t.length;e++)this.ctx.fillText(t[e],.5*s.WIDTH,.32*s.HEIGHT+30*e);this.controller1.draw(),this.controller2.draw();let e=this.controller1ctx;e.fillStyle="yellow",e.textAlign="left",e.font="24px 'Press Start 2P'",this.computerplayer1?e.fillText(`Level ${this.difficulty1} Computer`,245,45):e.fillText("Human Player 1",245,45),e=this.controller2ctx,e.fillStyle="yellow",e.textAlign="right",e.font="24px 'Press Start 2P'",this.computerplayer2?e.fillText(`Level ${this.difficulty2} Computer`,405,45):e.fillText("Human Player 2",405,45),this.gameStarted||requestAnimationFrame(this.draw.bind(this))}handleKeyDown(t){if(this.gameStarted)"Escape"===t.key&&(this.game.paused?(this.hideModal(),this.game.unpause()):(this.game.pause(),this.generatePauseModal()));else if(!this.showingModal){let e=t.key;"h"===e?this.togglePlayer1():"k"===e?this.togglePlayer2():" "===e?this.startGame():"w"===e?(this.difficulty1+=1,this.difficulty1>10&&(this.difficulty1=10)):"s"===e?(this.difficulty1-=1,this.difficulty1<1&&(this.difficulty1=1)):"ArrowUp"===e?(this.difficulty2+=1,this.difficulty2>10&&(this.difficulty2=10)):"ArrowDown"===e&&(this.difficulty2-=1,this.difficulty2<1&&(this.difficulty2=1))}}restartMenu(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.gameMusic.pause(),this.gameMusic.currentTime=0,this.menuMusic.currentTime=0,this.menuMusic.play(),this.controller1.removeListeners(),this.controller2.removeListeners(),this.controller1.addListeners(),this.controller2.addListeners(),this.gameStarted=!1,t&&this.generateEndModal(),this.howToButton.style.display="flex",this.startGameButton.style.display="flex",this.draw()}startGame(){let t,e;this.gameStarted=!0,this.howToButton.style.display="none",this.startGameButton.style.display="none",this.menuMusic.pause(),this.menuMusic.currentTime=0,this.gameMusic.currentTime=0,this.gameMusic.play(),this.computerplayer1?(this.controller1.removeListeners(),t=new d(null,1,this.controller1ctx,null,this.difficulty1)):t=this.controller1,this.computerplayer2?(this.controller2.removeListeners(),e=new d(null,2,this.controller2ctx,null,this.difficulty2)):e=this.controller2,this.game=new h(this.ctx,t,e,this),this.game.start(),this.muted&&this.game.mute()}stopGame(){this.lastWinner=this.game.winner(),this.game.mute(),delete this.game,this.restartMenu(!0)}togglePlayer1(){this.computerplayer1=!this.computerplayer1}togglePlayer2(){this.computerplayer2=!this.computerplayer2}addGamePad(t){void 0===this.controller1.gamepad?(this.controller1.removeListeners(),this.computerplayer1=!1,this.controller1=new u(t,this.controller1ctx)):void 0===this.controller2.gamepad&&(this.controller2.removeListeners(),this.computerplayer2=!1,this.controller2=new u(t,this.controller2ctx))}setupMusic(){this.menuMusic=new Audio("assets/music/Dani Stob - Facing The Enemy.mp3"),this.menuMusic.loop=!0,this.gameMusic=new Audio("assets/music/Dani Stob - Arena Fight.mp3"),this.gameMusic.loop=!0,this.muted=!1}toggleMute(){this.muted?(this.unmute(),this.muted=!1):(this.mute(),this.muted=!0)}mute(){this.menuMusic.volume=0,this.gameMusic.volume=0,this.muteButton.innerHTML="";let t=document.createElement("img");t.src="assets/images/Icons/mute-icon.png",this.muteButton.appendChild(t),this.game&&this.game.mute()}unmute(){this.menuMusic.volume=1,this.gameMusic.volume=1,this.muteButton.innerHTML="";let t=document.createElement("img");t.src="assets/images/Icons/volume-icon.png",this.muteButton.appendChild(t),this.game&&this.game.unmute()}}(m,g,f);window.addEventListener("gamepadconnected",(function(t){A.addGamePad(t.gamepad)}))}()}();
//# sourceMappingURL=main.js.map